<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>About - Погода</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="mstyle.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Quicksand&amp;display=swap"
    />
    <link
      rel="shortcut icon"
      href="./assets/icons/favicon.svg"
      type="image/x-icon"
    />
    <script src="./js/icon.js" crossorigin="anonymous"></script>
  </head>
  <body>
    <header>
      <a href="https://www.voenmeh.ru/" class="logo">
        <i class="fal fa-sun fa-3x"></i>
        <h4>&nbsp;Погода</h4>
      </a>

      <div class="navMain">
        <button class="openbtn" onclick="openNav()">&#9776;</button>
      </div>

      <div class="nav">
        <div id="mySidepanel" class="sidebar">
          <a href="javascript:void(0)" class="closebtn" onclick="closeNav()"
            >&times;
          </a>
          <ul>
            <li>
              <a href="index.html">Главная</a>
              <a class="active" href="about.html">Информация</a>
            </li>
          </ul>
        </div>
      </div>
    </header>

    <div class="contain">
      <div class="intro">
        <p>
        
#include <stdio.h><br />
#include <stdlib.h><br />
#include <string.h><br />
#include <windows.h><br />
struct person<br />
{<br />
       char name[30];<br />
       char importer[30];<br />
       int volume;<br />
};<br />
<br />
void add (char*);   /* добавить запись в файл */<br />
void edit (char*);  /* редактировать запись */<br />
void show (char*);  /* просмотреть содержимое файла */<br />
void search1 (char*);    /* найти самого старшего работника среди мужчин */<br />
void search2 (char*);  /*вывести список молодых специалистов до 28 лет с высшим образованием*/<br />
void del (char*);       /* удалить запись из файла */<br />
void printing (FILE *, int);<br />
<br />
int main (int argc, char* argv[])<br />
{<br />
    SetConsoleCP(1251);<br />
	SetConsoleOutputCP(1251);<br />
    char filename[80]; /*определение имени файла*/<br />
    if (argc > 1)<br />
        strcpy (filename, argv[1]);<br />
    else<br />
    {<br />
        puts("Введите имя файла для обработки");<br />
        gets(filename);<br />
    }<br />
    int menu;<br />
    do<br />
    {<br />
       system ("CLS");<br />
       puts ("1. Добавление записи");<br />
       puts ("2. Редактирование записи");<br />
       puts ("3. Просмотр записей");<br />
       puts ("4. Удаление записи");<br />
       puts ("5. Вывод страны и объема по товару");<br />
       puts ("6. Выход");<br />
       scanf ("%d%*c", &menu);<br />
       switch (menu)<br />
       {<br />
              case 1 : add (filename); break;<br />
              case 2 : edit (filename); break;<br />
              case 3 : show (filename); break;<br />
              case 4 : del (filename); break;<br />
              case 5 : search1 (filename); break;<br />
       }<br />
    }<br />
    while (menu!=6);<br />
    return 0;<br />
}<br />
<br />
/*заполнение одной записи (ввод данных о клиенте)*/<br />
struct person input_client (void)<br />
{<br />
     struct person employee;<br />
     int temp;<br />
     puts ("Наименование");<br />
     gets (employee.name);<br />
     puts("Страна-импортер");<br />
     gets( employee.importer);<br />
     puts("Объем");<br />
     scanf("%d", &temp);<br />
     employee.volume = temp;<br />
     getchar();<br />
     return employee;<br />
}<br />
<br />
/* функция добавления записи в файл */<br />
void add (char* file)<br />
{<br />
     FILE * f;<br />
     struct person employee;<br />
     system ("CLS");<br />
     if ((f=fopen (file, "ab"))==NULL)<br />
     {<br />
          perror ("Ошибка открытия файла");<br />
          getchar();<br />
          return;<br />
     }<br />
     employee = input_client();<br />
     fwrite (&employee, sizeof (employee), 1, f);<br />
     fclose (f);<br />
}<br />
<br />
/* функция вывода на экран одной записи */<br />
void print1 (struct person data)<br />
{<br />
    printf ("Наименование : %s\nСтрана-импортер : %s\nОбъем : %d",
            data.name, data.importer, data.volume);<br />
}<br />
<br />
/* функция редактирования записи */<br />
void edit (char* file)<br />
{<br />
     FILE * f;<br />
     struct person employee;<br />
     char name[30],yes;<br />
     system ("CLS");<br />
     if ((f=fopen (file, "rb+"))==NULL)<br />
     {<br />
          perror ("Ошибка открытия файла"); getchar();<br />
          return;<br />
     }<br />
     printf ("Наименование: "); gets (name);<br />
     while (fread(&employee,sizeof(employee), 1, f))<br />
        if (!strcmp(employee.name,name))<br />
        {<br />
             print1 (employee);<br />
             puts ("\nРедактировать? (y/n)");<br />
             do<br />
             {<br />
                  yes = getchar(); getchar();<br />
             }<br />
             while (yes!='y' && yes!='Y' && yes!='n' && yes!='N');<br />
             if (yes=='y' || yes=='Y')<br />
             {<br />
                  employee = input_client();<br />
                  fseek (f,-sizeof(employee),SEEK_CUR);<br />
                  fwrite (&employee, sizeof (employee), 1, f);<br />
                  fseek (f,0,SEEK_CUR);<br />
             }<br />
        }<br />
     puts ("Поиск завершен"); getchar();<br />
     fclose(f);<br />
}<br />
<br />
/* функция печати содержимого файла */<br />
void show (char* file)<br />
{<br />
     FILE * f;<br />
     int menu, menu2;<br />
     struct person employee;<br />
     int k=0;<br />
     system ("CLS");<br />
     if ((f=fopen (file, "rb"))==NULL)<br />
     {<br />
          perror ("Ошибка открытия файла");<br />
          getchar();<br />
          return;<br />
     }<br />
    puts ("|  N |             Наименование              |      Страна-Импортер      |   Объем   |");<br />
    puts ("--------------------------------------------------------------------------------------");<br />
    while(fread(&employee, sizeof(employee), 1, f)==1)<br />
     {<br />
                printf ("|%3d | %-37.30s |%-26s |%-8d   |\n",
                ++k, employee.name, employee.importer, employee.volume);
                puts ("--------------------------------------------------------------------------------------");<br />
                }<br />
    fclose(f);<br />
    getchar(); getchar();<br />
}<br />


/* функция удаления записи из файла */<br />
void del (char* file)<br />
{<br />

    FILE *f1, *f2;<br />
    unsigned int n, n_file, i = 0;<br />
    struct person employee;<br />
    system ("CLS");<br />
    if ((f1=fopen (file, "rb"))==NULL)<br />
    {<br />
        perror ("Ошибка открытия файла"); getchar();<br />
        return;<br />
    }<br />
    fseek (f1, 0, SEEK_END);<br />
    n_file = ftell(f1) / sizeof (employee);<br />
    if (n_file == 0)<br />
    {<br />
        puts ("Файл пуст"); getchar();<br />
        return;<br />
    }<br />
    puts ("Номер удаляемой записи?");<br />
    scanf ("%u", &n);<br />
    if ( n > n_file )<br />
    {<br />
        puts ("Некорректный номер");<br />
        getchar();getchar();<br />
        fclose (f1);<br />
        return;<br />
    }<br />
    rewind (f1);<br />
    if ((f2=fopen ("temp.dat", "wb"))==NULL)<br />
    {<br />
        perror ("Ошибка открытия файла");<br />
        getchar();<br />
        return;<br />
    }<br />
    while ( fread(&employee, sizeof(employee), 1, f1)==1 )<br />
    {<br />
        i++;<br />
        if ( i != n )<br />
            fwrite(&employee, sizeof(employee), 1, f2);<br />
    }<br />
    fclose (f1);<br />
    fclose (f2);<br />
    remove (file);<br />
    rename ("temp.dat", file);<br />
    puts ("Запись удалена");<br />
    getchar();getchar();<br />
}<br />


/* функция поиска по товару */<br />
void search1 (char* file)<br />
{<br />
     FILE * f;<br />
     struct person employee, required;<br />
     char req[30];<br />
     int max_age = 3000, age;<br />
     system ("CLS");<br />
     if ((f=fopen (file, "rb"))==NULL)<br />
     {<br />
          perror ("Ошибка открытия файла"); getchar();<br />
          return;<br />
     }<br />
     puts ("Введите искомый товар : ");<br />
     gets(req);<br />
     while (fread(&employee, sizeof(employee), 1, f)==1)<br />
        if (!strcmp(employee.name,req))<br />
        {<br />
            printf("\n");<br />
            print1 (employee);<br />
            printf("\n");<br />
        }<br />
     fclose(f);<br />
     getchar();getchar();<br />
}<br />

        </p>
        <a href="https://www.voenmeh.ru/" target="_blank">
          <i class="fab fa-github fa-2x"></i>
          <h2>&nbsp;Военмех</h2>
        </a>
      </div>
    </div>

    <footer class="footerA">
      <p>&#169; Работа по Практике Палёнова Александра И508Б</p>
    </footer>

    <div class="abgimg">
      <img src="assets/about.jpg" alt="weather-img" scroll="no" />
    </div>

    <script src="./js/nav.js"></script>
  </body>
</html>
