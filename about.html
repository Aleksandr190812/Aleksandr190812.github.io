<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>About - Погода</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="mstyle.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Quicksand&amp;display=swap"
    />
    <link
      rel="shortcut icon"
      href="./assets/icons/favicon.svg"
      type="image/x-icon"
    />
    <script src="./js/icon.js" crossorigin="anonymous"></script>
  </head>
  <body>
    <header>
      <a href="https://www.voenmeh.ru/" class="logo">
        <i class="fal fa-sun fa-3x"></i>
        <h4>&nbsp;Погода</h4>
      </a>

      <div class="navMain">
        <button class="openbtn" onclick="openNav()">&#9776;</button>
      </div>

      <div class="nav">
        <div id="mySidepanel" class="sidebar">
          <a href="javascript:void(0)" class="closebtn" onclick="closeNav()"
            >&times;
          </a>
          <ul>
            <li>
              <a href="index.html">Главная</a>
              <a class="active" href="about.html">Информация</a>
            </li>
          </ul>
        </div>
      </div>
    </header>

    <div class="contain">
      <div class="intro">
        <p>
          #include <iostream><br />
#include <stdlib.h><br />
#include <stdio.h><br />
#include <unistd.h><br />
#include <fcntl.h><br />
#include <signal.h><br />
#include <string.h><br />

void SIGUSR1_Handler(int signal);<br />
void SIGTERM_Handler(int signal);<br />
void CloseFile();<br />
<br />
int currentFileSize = 0;<br />
int fileDescriptor = -1;<br />
int exitFlag = 0;<br />
int fileClosedFlag = 0;<br />
<br />
int main(int argc, char const *argv[])<br />
{<br />
    if (argc != 2)<br />
    {<br />
        printf("Wrong command line's arguments\n");<br />
        return 1;<br />
    }<br />
    printf("\nStart of programm\n");<br />
<br />
    struct sigaction act;<br />
    sigset_t set;<br />

    memset(&act,0,sizeof(act));<br />
    act.sa_handler = SIGUSR1_Handler;<br />
    sigemptyset(&set);<br />
    sigaddset(&set, SIGUSR1);<br />
    act.sa_mask = set;<br />
    sigaction(SIGUSR1, &act, 0);<br />
<br />
    memset(&act, 0, sizeof(act));<br />
    act.sa_handler = SIGTERM_Handler;<br />
    sigemptyset(&set);<br />
    sigaddset(&set, SIGTERM);<br />
    act.sa_mask = set;<br />
    sigaction(SIGTERM, &act, 0);<br />
<br />
    fileDescriptor = open("example", 0_RDWR | 0_CREAT | 0_TRUNC, 00600);<br />
    if (fileDescriptor == -1)<br />
    {<br />
        printf("\nFile creation error\n");<br />
        return 1;<br />
    }<br />
    else printf("\nFile was created successfilly\n");<br />
    raise(SIGUSR1);<br />
    printf("\nStart of filling file\n");<br />
<br />
    int bytesQuantity = atoi(argv[1]);<br />
    for (currentFileSize = 0; currentFileSize < bytesQuantity; currentFileSize++) <br />
    {<br />
        if(exitFlag)<br />
            return 0;<br />

        char randomValue = (char)(rang() % 256);<br />
        if (write(fileDescriptor, (void*)(&randomValue), sizeof(randomValue)) == -1)<br />
        {<br />
            printf("\nFile writing error\n");<br />
            CloseFile();<br />
            return 1;<br />
        }<br />
    }<br />

    printf("\nEnd of filling file\n");<br />
    CloseFile();<br />
    printf("\nEnd of programm\n");<br />
    return 0; <br />
}<br />
<br />
void SIGUSR1_Handler(int signal)<br />
{<br />
    printf("\n Current file size is %d bytes\n", currentFileSize);<br />
}<br />
<br />
void SIGTERM_Handler(int signal)<br />
{<br />
    printf("\nProgramm has been interrupted by SIGTERM\n");<br />
    CloseFile();<br />
    if (unlink("example") == -1)<br />
        printf("\nFile could'n be deleted\n");<br />
    else<br />
        printf("\nFile was deleted successfully\n");<br />
    exitFlag = 1;<br />
}<br />
<br />
void CloseFile()<br />
{<br />
    if (fileClosedFlag)<br />
        return;<br />
    if (close(fileDescriptor) == -1)<br />
    {<br />
        printf("\nFile couldn't be closed\n");<br />
        fileClosedFlag = 0;<br />
    }<br />
    else<br />
    {<br />
        printf("\nFile was closed Successfilly\n");<br />
        fileClosedFlag = 1;<br />
    }<br />
} <br />
        </p>
        <a href="https://www.voenmeh.ru/" target="_blank">
          <i class="fab fa-github fa-2x"></i>
          <h2>&nbsp;Военмех</h2>
        </a>
      </div>
    </div>

    <footer class="footerA">
      <p>&#169; Работа по Практике Палёнова Александра И508Б</p>
    </footer>

    <div class="abgimg">
      <img src="assets/about.jpg" alt="weather-img" scroll="no" />
    </div>

    <script src="./js/nav.js"></script>
  </body>
</html>
